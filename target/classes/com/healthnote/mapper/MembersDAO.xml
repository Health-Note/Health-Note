<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.healthnote.members.dao.MembersDAO">

	<select id="getMemberAndFixedSchedule" parameterType="String" resultType="com.healthnote.vo.MemberAndFixedScheduleDTO">
		select t1.*, t2.day, t2.start_time, t2.end_time
		from members t1
		    ,fixedschedule t2
		where 1=1
		and t1.phonenum = t2.phonenum
		and t1.email = #{trainerId}		
	</select>
	
	<delete id="deleteMember">
		delete from members
		where phonenum = #{phonenum}
	</delete>

	<update id="changeMemberInfo" parameterType="com.healthnote.vo.MemberDTO">
		update members
		set <if test ="name != null">name = #{name},</if>
		    <if test ="gender != null">gender = #{gender},</if>
		    <if test ="start_date != null">start_date = #{start_date},</if>
		    <if test ="end_date != null">end_date = #{end_date},</if>
		    <if test ="unusedpt != null">unusedpt = #{unusedpt},</if>
		    <if test ="usedpt != null">usedpt = #{usedpt},</if>
		    <if test ="height != null">height = #{height},</if>
			email = #{email}
		where 1=1
		and phonenum = #{phonenum}
	</update>
	
	<insert id="insertMember" parameterType="com.healthnote.vo.MemberDTO">
		insert into members values(#{phonenum}, #{name}, #{gender}, #{start_date}, #{end_date}, #{unusedpt}, #{usedpt}, #{email}, #{height})
	</insert>
	
	<insert id="insertFixedSchedule" parameterType="com.healthnote.vo.FixedScheduleDTO">
		insert into fixedschedule values(#{day}, #{phonenum}, #{start_time}, #{end_time})
	</insert>
	
	<delete id="deleteFixedSchedule" parameterType="com.healthnote.vo.FixedScheduleDTO">
		delete from fixedschedule
		where 1=1
		and day = #{day}
		and phonenum = #{phonenum}
	</delete>
	
	<update id="changeFixedSchedule" parameterType="com.healthnote.vo.ChangeFixedScheduleDTO">
		update fixedschedule
		set day = #{after_day}, start_time = #{start_time}, end_time = #{end_time}
		where 1=1
		and day = #{before_day}
		and phonenum = #{phonenum}
	</update>
		
</mapper>

<!--

	/*
	 
	 빈칸 클릭  				인서트(1시간 단위로 들어온다) 
	 드래그 					업데이트(화면에서 막을지 아니면 뒷 단에서 막을지 아니면 화면과 뒷단 모두에서 막을지 고민하여 체크로직 넣어야함) 
	 이미 있는거 클릭 하여 삭제   딜리트 
	
	*/
	

  -->